# Kleidas API

This repository provides a RESTful API that interacts with a MongoDB collection (`verses`) containing individual verses from the King James Bible. Each verse includes context such as book, chapter, and verse number, and is tagged with keywords that describe theological themes.

## Features
- Retrieve individual verses by ID.
- Search for verses by book, chapter, and verse.
- Query verses by thematic keywords or theological concepts.
- Add, update, and delete verses in the database.

---

## Table of Contents
1. [API Documentation](#api-documentation)
    - [GET /verses](#get-verses)
    - [GET /verses/:id](#get-versesid)
2. [Database Schema](#database-schema)
3. [Example Queries](#example-queries)

---

## API Documentation

### 1. GET /verses

**Description**: Fetch all verses, with optional filters for book, chapter, verse, and keywords.

**Query Parameters**:
- `book_name` (optional): The full name of the book (e.g., `Revelation`).
- `book_abbr` (optional): The book abbreviation (e.g., `Re`)
- `chapter_id` (optional): The chapter number.
- `start_verse_id` (optional): The starting verse number for a range.
- `end_verse_id` (optional): The ending verse number for a range.
- `word_search` (optional): A keyword or phrase to search for within the `keywords` field.

**Example Request**:
```bash
GET /verses?book_name=Revelation&chapter_id=6&start_verse_id=6&end_verse_id=6
```

**Response**:
Returns an array of verse documents that match the query.

**Example Response**:
```json
[
    {
        "book_id": 66,
        "book_name": "Revelation",
        "verses": [
            {
                "_id": "66f35538411e2dc5fa0053c8",
                "chapter_id": 6,
                "verse_id": 6,
                "verse_text": "And I heard a voice in the midst of the four beasts say, A measure of wheat for a penny, and three measures of barley for a penny; and [see] thou hurt not the oil and the wine.",
                "keywords": [
                    "Four Horsemen",
                    "Third Seal",
                    "Black Horse",
                    "Famine",
                    "Economic Collapse",
                    "Great Depression",
                    "Inflation",
                    "Global Poverty",
                    "Dispensationalism",
                    "Tribulation",
                    "Seven-Year Tribulation",
                    "Israel's Restoration",
                    "Seventy Weeks of Daniel"
                ]
            }
        ]
    }
]%
```

---

### 2. GET /verses/:id

**Description**: Fetch a single verse by its unique MongoDB `_id`.

**Path Parameter**:
- `id`: The unique ID of the verse.

**Example Request**:
```bash
GET /verses/60f1e75f68a6e912e6e2b9e7
```

**Response**:
Returns the verse document associated with the given ID.

---

## Database Schema

Each verse is stored as a document in the `verses` collection in MongoDB. The schema for each verse is as follows:

### Example Document:
```json
{
  "_id": {"$oid": "66f35538411e2dc5fa0053c8"},
  "book_abbr": "Re",
  "book_id": 66,
  "book_name": "Revelation",
  "chapter_id": 6,
  "keywords": [
    "Four Horsemen", "Famine", "Tribulation", "Seven-Year Tribulation"
  ],
  "verse_id": 6,
  "verse_text": "And I heard a voice in the midst of the four beasts say..."
}
```

### Field Descriptions:

| Field        | Type              | Description                                                                                 |
|--------------|-------------------|---------------------------------------------------------------------------------------------|
| `_id`        | ObjectId           | Unique identifier for each verse, auto-generated by MongoDB.                                |
| `book_abbr`  | String             | Abbreviation of the book name (e.g., `"Re"` for Revelation).                                |
| `book_id`    | Number             | Numeric identifier of the book.                                                             |
| `book_name`  | String             | Full name of the book (e.g., `"Revelation"`).                                                |
| `chapter_id` | Number             | Chapter number.                                                                             |
| `verse_id`   | Number             | Verse number within the chapter.                                                            |
| `verse_text` | String             | Text of the verse as it appears in the King James Bible.                                    |
| `keywords`   | Array of Strings   | Tags that categorize or describe the themes, events, or theological concepts of the verse.   |

---

## Example Queries

Here are some common queries you can use with MongoDB to interact with the `verses` collection:

### 1. Find a Specific Verse:
To retrieve a specific verse by its book, chapter, and verse number:
```javascript
db.verses.findOne({
  book_name: "John",
  chapter_id: 3,
  verse_id: 16
})
```

### 2. Find All Verses in a Chapter:
```javascript
db.verses.find({
  book_name: "Genesis",
  chapter_id: 1
})
```

### 3. Find Verses by Keyword:
```javascript
db.verses.find({
  keywords: "Faith"
})
```

### 4. Search for Partial Keyword Matches:
```javascript
db.verses.find({
  keywords: { $elemMatch: { $regex: "Tribulation", $options: "i" } }
})
```

### 5. Find Verses in a Range:
```javascript
db.verses.find({
  book_name: "Matthew",
  chapter_id: 5,
  verse_id: { $gte: 1, $lte: 10 }
})
```

---

## Running the API

1. Clone this repository.
2. Install dependencies:
   ```bash
   npm install
   ```
3. Start the Express server:
   ```bash
   node index.js
   ```
   The server will be running at `http://localhost:3000`.

---

This API provides a flexible way to search, add, and manage King James Bible verses, making it ideal for Bible study applications or theological research tools.